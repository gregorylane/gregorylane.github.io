#NOTE: for branch level profits keep full sample, not just eligible
temp2 <- loans %>% filter(((year>=2016 & month >= 4) | year >=2017),
projectcode==15, lnstatus_end!=0) %>%
group_by(id, month, year) %>%
summarise(hchyid = mean(hchyid, na.rm=TRUE),
miss_pay_behind = sum(miss_pay_behind, na.rm=TRUE),
credit_score = mean(credit_score, na.rm=TRUE),
treatment = mean(treatment, na.rm=TRUE),
flood_prep = mean(flood_prep, na.rm=TRUE),
flood_distress = mean(flood_distress, na.rm=TRUE),
district = first(district),
revenue = sum(profit, na.rm=TRUE),
cost = mean(principalamt, na.rm=TRUE),
activity1 = first(activity1),
activity2 = first(activity2)) %>%
ungroup() %>%
group_by(hchyid, month, year) %>%
summarise(miss_pay_behind = sum(miss_pay_behind, na.rm=TRUE),
treatment = mean(treatment, na.rm=TRUE),
flood_prep = mean(flood_prep, na.rm=TRUE),
flood_distress = mean(flood_distress, na.rm=TRUE),
district = first(district),
revenue = sum(revenue, na.rm=TRUE),
cost = mean(cost, na.rm=TRUE),
activity1 = first(activity1),
activity2 = first(activity2),
num_members = n())
temp2 %<>% mutate(profit = revenue - cost)
temp2 %<>% mutate(profit = profit / num_members)
reg_profit3 <- felm(profit ~ treatment  | district + month | 0 | hchyid, data = temp2)
summary(reg_profit3)
#break out profit by month
temp2 %<>% mutate(month2 = ifelse(month >3 & year==2016, month - 4, month + 8),
month_treat = as.factor(month2 * treatment))
#temp2 %<>% mutate(profit = profit / num_members)
reg_profit_monthly <- felm(profit ~ month_treat  | district + month2 | 0 | hchyid,
data = temp2 %>% filter((year==2016 & month >4) | (year==2017 & month <5)))
summary(reg_profit_monthly)
#make graph of treatment effect
month_graph <- data.frame(matrix(ncol = 3, nrow = length(reg_profit_monthly$beta)))
x <- c("time", "beta", "se")
colnames(month_graph) <- x
for(i in 1:length(reg_profit_monthly$beta)) {
month_graph[i,2] <- reg_profit_monthly$beta[i]
month_graph[i,3] <- reg_profit_monthly$cse[i]
}
View(month_graph)
time <- c(1, 10, 11, 12, 2, 3, 4, 5, 6, 7, 8, 9)
month_graph[,1] <- time
View(month_graph)
month_graph <- month_graph %>% mutate(upper = beta + 1.96*se ,
lower = beta - 1.96*se)
View(month_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=lower), linetype=2) +
geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph)
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=lower), linetype=2) +
geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph)
?gemo_spike
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05))
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph
)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
#geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
#geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="blue", alpha=0.05) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="grey01", alpha=0.05) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.01) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.04) +
theme_bw()
plot(profit_graph)
g
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.4) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to Feb 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
plot(profit_graph)
summary(temp2$month)
summary(temp2$month2)
#temp2 %<>% mutate(profit = profit / num_members)
reg_profit_monthly <- felm(profit ~ month_treat  | district + month2 | 0 | hchyid,
data = temp2 %>% filter((year==2016 & month >4) | (year==2017 & month <12)))
summary(reg_profit_monthly)
#make graph of treatment effect
month_graph <- data.frame(matrix(ncol = 3, nrow = length(reg_profit_monthly$beta)))
x <- c("time", "beta", "se")
colnames(month_graph) <- x
for(i in 1:length(reg_profit_monthly$beta)) {
month_graph[i,2] <- reg_profit_monthly$beta[i]
month_graph[i,3] <- reg_profit_monthly$cse[i]
}
time <- c(1, 10, 11, 12, 2, 3, 4, 5, 6, 7, 8, 9)
month_graph[,1] <- time
#time <- c(1, 10, 11, 12, 2, 3, 4, 5, 6, 7, 8, 9)
time <- c(1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 3, 4, 5, 6, 7, 8, 9)
month_graph[,1] <- time
month_graph <- month_graph %>% mutate(upper = beta + 1.96*se ,
lower = beta - 1.96*se)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <13), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <19), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <19), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=3.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.5, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.5, xmax=17.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.8, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
?hline
?gemo_hline
?geom_hline
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_hline(xintercept=0) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_hline(yintercept=0) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_hline(yintercept=0, linetype=2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.2) +
geom_hline(yintercept=0, linetype=2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to November 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
ggsave(filename="profit_monthly.pdf", plot=profit_graph, path = dir_save_fig)
#graph from April to December - for first year only, to remove confounding effect of carry-on
profit_graph <- ggplot(month_graph %>% filter(time <20), aes(x=as.factor(time), y=beta)) +
geom_rect(aes(xmin=2.9, xmax=5.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.3) +
geom_rect(aes(xmin=14.9, xmax=17.4, ymin=-Inf, ymax=Inf), fill="aliceblue", alpha=0.3) +
geom_hline(yintercept=0, linetype=2) +
geom_point() +
geom_line(aes(x=time, y=beta)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
position=position_dodge(0.05)) +
#geom_line(aes(x=time, y=lower), linetype=2) +
#geom_line(aes(x=time, y=upper), linetype=2) +
#geom_errorbar(aes(ymin=lower, ymax=upper), width=.2,
#               position=position_dodge(.9)) +
#scale_x_discrete(name = "May 2016 to April 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
#      labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr")) +
scale_x_discrete(name = "May 2016 to November 2017", breaks=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"),
labels=c("May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr",
"May", "June", "July", "Aug", "Sept", "Oct", "Nov")) +
scale_y_continuous(name="Treatment Effect on Profits", limits=c(NA, NA)) +
theme_bw()
plot(profit_graph)
ggsave(filename="profit_monthly.pdf", plot=profit_graph, path = dir_save_fig)
setwd("~/Website/gregorylane.github.io")
rmarkdown::render_site()
rmarkdown::render_site()
