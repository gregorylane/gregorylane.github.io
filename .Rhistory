# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION ------------------------------------------------------------
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS
keys <- bind_rows(pure_c, control)
View(keys)
############ V-LookUp Creation for Matatu V2 #####################
# Created by: Greg & Erin
# Date created: 8/3/2018
# Purpose: Create V LookUp file for surveys
##################################################################
#Edited on August 19th to randomize order of each treatment arm
#Echo printed 35 pure control and control for the first day of the pilot, so updated
#the key numbers so we don't duplicate
#THIS IS ONLY PURE CONTROL AND CONTROL FOR THE PILOT STAGES
rm(list = ls())
library(pacman)
p_load(data.table, foreign, tidyverse, magrittr, stringr)
#Notes: Keys will all be 5 digits.
# First digit must be 1, 5, or 9
# 1 = Pure Control, 5 = Control, 9 = Treatment
# Subsidy or not will just be random
#Create random order for treatment -----------------------------------------------------------------
set.seed(10121984)
# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION ------------------------------------------------------------
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS - Make sure to modify 'sub_sacco' to choose subsidized sacco
keys <- bind_rows(pure_c, control) %>%  #removed 'treat'
# adding labels
mutate(info = ifelse(key < 20000, 0, ifelse(
key < 60000 & key > 49999, 1, 2)),
infoLabel = ifelse(info == 0, "PureControl", ifelse(
info==1, "Control", "Treatment"))) %>%
group_by(info) %>%
mutate(seq_within = seq_along(info))
View(keys)
keys %<>% mutate(sub_sacco = 3, #Chooses sacco to subsidize
name_sub_sacco = ifelse(sub_sacco==0 & subsidy==1, "NairobiG",
ifelse(sub_sacco==1 & subsidy==1, "Transafaris",
ifelse(sub_sacco==2 & subsidy==1, "Sasaline",
ifelse(sub_sacco==3 & subsidy==1, "Trippin",
ifelse(sub_sacco==4 & subsidy==1, "ClassicLuxuryShuttle", ""))))))
View(keys)
# rawest form
random_list_tmp <- left_join(order, keys, by = c('infoLabel', 'seq_within'))
View(order)
View(keys)
View(keys)
View(random_list_tmp)
# for output
random_list_1 <- random_list_tmp %>% select(-seq_across, -seq_within)
View(random_list_1)
summary(as.factor(random_list_1$infoLabel))
############ V-LookUp Creation for Matatu V2 #####################
# Created by: Greg & Erin
# Date created: 8/3/2018
# Purpose: Create V LookUp file for surveys
##################################################################
#Edited on August 19th to randomize order of each treatment arm
#Echo printed 35 pure control and control for the first day of the pilot, so updated
#the key numbers so we don't duplicate
#THIS IS ONLY PURE CONTROL AND CONTROL FOR THE PILOT STAGES
rm(list = ls())
library(pacman)
p_load(data.table, foreign, tidyverse, magrittr, stringr)
#Notes: Keys will all be 5 digits.
# First digit must be 1, 5, or 9
# 1 = Pure Control, 5 = Control, 9 = Treatment
# Subsidy or not will just be random
#Create random order for treatment -----------------------------------------------------------------
set.seed(10121984)
# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION ------------------------------------------------------------
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS - Make sure to modify 'sub_sacco' to choose subsidized sacco
keys <- bind_rows(pure_c, control) %>%  #removed 'treat'
# adding labels
mutate(info = ifelse(key < 20000, 0, ifelse(
key < 60000 & key > 49999, 1, 2)),
infoLabel = ifelse(info == 0, "PureControl", ifelse(
info==1, "Control", "Treatment"))) %>%
group_by(info) %>%
mutate(seq_within = seq_along(info))
keys %<>% mutate(sub_sacco = 3, #Chooses sacco to subsidize
name_sub_sacco = ifelse(sub_sacco==0 & subsidy==1, "NairobiG",
ifelse(sub_sacco==1 & subsidy==1, "Transafaris",
ifelse(sub_sacco==2 & subsidy==1, "Sasaline",
ifelse(sub_sacco==3 & subsidy==1, "Trippin",
ifelse(sub_sacco==4 & subsidy==1, "ClassicLuxuryShuttle", ""))))))
# CREATING FINAL RANDOMIZATION LIST ------------------------------------------------------------------
# rawest form
random_list_tmp <- left_join(order, keys, by = c('infoLabel', 'seq_within'))
# for output
random_list_1 <- random_list_tmp %>% select(-seq_across, -seq_within)
#write_csv(keys, "~/Dropbox/Matatu_project_David_Fred/rct_docs/surveys/look_up/look_up_pilot.csv")
write_csv(random_list_1, "~/Dropbox/Matatu_v2/rct_docs/surveys/look_up/look_up_pilot_pureC_and_C.csv")
#Edited on August 19th to randomize order of each treatment arm
#Echo printed 35 pure control and control for the first day of the pilot, so updated
#the key numbers so we don't duplicate
#THIS IS ONLY PURE CONTROL AND CONTROL FOR THE PILOT STAGES
rm(list = ls())
library(pacman)
p_load(data.table, foreign, tidyverse, magrittr, stringr)
#Notes: Keys will all be 5 digits.
# First digit must be 1, 5, or 9
# 1 = Pure Control, 5 = Control, 9 = Treatment
# Subsidy or not will just be random
#Create random order for treatment -----------------------------------------------------------------
set.seed(10121984)
# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION -----------------------------------------------------------------
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS -------------------------------------------------------------------------------
#Make sure to modify 'sub_sacco' to choose subsidized sacco
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
keys <- bind_rows(pure_c, control) %>%  #removed 'treat'
# adding labels
mutate(info = ifelse(key < 20000, 0, ifelse(
key < 60000 & key > 49999, 1, 2)),
infoLabel = ifelse(info == 0, "PureControl", ifelse(
info==1, "Control", "Treatment"))) %>%
group_by(info) %>%
mutate(seq_within = seq_along(info))
keys %<>% mutate(sub_sacco = 3, #Chooses sacco to subsidize
name_sub_sacco = ifelse(sub_sacco==0 & subsidy==1, "NairobiG",
ifelse(sub_sacco==1 & subsidy==1, "Transafaris",
ifelse(sub_sacco==2 & subsidy==1, "Sasaline",
ifelse(sub_sacco==3 & subsidy==1, "Trippin",
ifelse(sub_sacco==4 & subsidy==1, "ClassicLuxuryShuttle", ""))))))
# CREATING FINAL RANDOMIZATION LIST ------------------------------------------------------------------
# rawest form
random_list_tmp <- left_join(order, keys, by = c('infoLabel', 'seq_within'))
# for output
random_list_1 <- random_list_tmp %>% select(-seq_across, -seq_within)
#write_csv(keys, "~/Dropbox/Matatu_project_David_Fred/rct_docs/surveys/look_up/look_up_pilot.csv")
write_csv(random_list_1, "~/Dropbox/Matatu_v2/rct_docs/surveys/look_up/look_up_pilot_pureC_and_C.csv")
View(random_list_1)
############ V-LookUp Creation for Matatu V2 #####################
# Created by: Greg & Erin
# Date created: 8/3/2018
# Purpose: Create V LookUp file for surveys
##################################################################
#Edited on August 19th to randomize order of each treatment arm
#Echo printed 35 pure control and control for the first day of the pilot, so updated
#the key numbers so we don't duplicate
#THIS IS ONLY PURE CONTROL AND CONTROL FOR THE PILOT STAGES
rm(list = ls())
library(pacman)
p_load(data.table, foreign, tidyverse, magrittr, stringr)
#Notes: Keys will all be 5 digits.
# First digit must be 1, 5, or 9
# 1 = Pure Control, 5 = Control, 9 = Treatment
# Subsidy or not will just be random
#Create random order for treatment -----------------------------------------------------------------
set.seed(10121983)
# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION -----------------------------------------------------------------
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS -------------------------------------------------------------------------------
#Make sure to modify 'sub_sacco' to choose subsidized sacco
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
keys <- bind_rows(pure_c, control) %>%  #removed 'treat'
# adding labels
mutate(info = ifelse(key < 20000, 0, ifelse(
key < 60000 & key > 49999, 1, 2)),
infoLabel = ifelse(info == 0, "PureControl", ifelse(
info==1, "Control", "Treatment"))) %>%
group_by(info) %>%
mutate(seq_within = seq_along(info))
keys %<>% mutate(sub_sacco = 3, #Chooses sacco to subsidize
name_sub_sacco = ifelse(sub_sacco==0 & subsidy==1, "NairobiG",
ifelse(sub_sacco==1 & subsidy==1, "Transafaris",
ifelse(sub_sacco==2 & subsidy==1, "Sasaline",
ifelse(sub_sacco==3 & subsidy==1, "Trippin",
ifelse(sub_sacco==4 & subsidy==1, "ClassicLuxuryShuttle", ""))))))
# CREATING FINAL RANDOMIZATION LIST ------------------------------------------------------------------
# rawest form
random_list_tmp <- left_join(order, keys, by = c('infoLabel', 'seq_within'))
# for output
random_list_1 <- random_list_tmp %>% select(-seq_across, -seq_within)
#write_csv(keys, "~/Dropbox/Matatu_project_David_Fred/rct_docs/surveys/look_up/look_up_pilot.csv")
write_csv(random_list_1, "~/Dropbox/Matatu_v2/rct_docs/surveys/look_up/look_up_pilot_pureC_and_C.csv")
View(random_list_1)
summary(as.factor(random_list_1$infoLabel))
############ V-LookUp Creation for Matatu V2 #####################
# Created by: Greg & Erin
# Date created: 8/3/2018
# Purpose: Create V LookUp file for surveys
##################################################################
#Edited on August 19th to randomize order of each treatment arm
#Echo printed 35 pure control and control for the first day of the pilot, so updated
#the key numbers so we don't duplicate
#THIS IS ONLY PURE CONTROL AND CONTROL FOR THE PILOT STAGES
rm(list = ls())
library(pacman)
p_load(data.table, foreign, tidyverse, magrittr, stringr)
#Notes: Keys will all be 5 digits.
# First digit must be 1, 5, or 9
# 1 = Pure Control, 5 = Control, 9 = Treatment
# Subsidy or not will just be random
#Create random order for treatment -----------------------------------------------------------------
set.seed(12301988)
# PARAMETERS TO CHANGE MAKE ------------------------------------------------------------------
batch_size <- 100 #number for new set of randomization
start <- 36 #This is the max of each group were printed previously (get this from echo or previous csv)
# CREATING RANDOMIZATION ORDER ------------------------------------------------------------------
# create the randomization order
order <- data.frame(infoLabel = sample(c("PureControl", "Control"), size = batch_size, replace=TRUE)) %>%
# get order overal so can resort
mutate(seq_across = seq_along(infoLabel)) %>%
# get order within group
group_by(infoLabel) %>%
mutate(seq_within = seq_along(infoLabel)) %>%
ungroup()
# grab maximum number for each group in the random ordering
max_pc <- as.numeric(max(order %>% filter(infoLabel =='PureControl') %>% select(seq_within)))
max_c <- as.numeric(max(order %>% filter(infoLabel =='Control') %>% select(seq_within)))
#max_t <- as.numeric(max(order %>% filter(infoLabel =='Treatment') %>% select(n)))
# CREATING KEYS FOR PAMPHLETS ------------------------------------------------------------------
pure_c <- seq(start + 10000, start + 10000 + max_pc -1 , 1)
control <- seq(start + 50000, start + 50000 + max_c -1 , 1)
#treat <- seq(start + 90000, start + 90000 + max_t, 1)
# CREATE SUBSIDY RANDOMIZATION -----------------------------------------------------------------
pure_c <- data.frame(key = c(pure_c)) %>%
mutate(rnum =runif(n=max_pc)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
control <- data.frame(key = c(control)) %>%
mutate(rnum =runif(n=max_c)) %>%
arrange(rnum) %>%
mutate(seq = seq_along(rnum),
subsidy = as.numeric(seq <= max_pc/2)) %>%
arrange(key) %>%
select(-rnum, -seq)
# treat <- data.frame(key = c(treat)) %>%
#  mutate(rnum =runif(n=max_t)) %>%
#  arrange(rnum) %>%
#  mutate(seq = seq_along(rnum),
#         subsidy = as.numeric(seq <= max_pc/2)) %>%
#  arrange(key) %>%
# select(-rnum, -seq)
# ADD LABELS -------------------------------------------------------------------------------
#Make sure to modify 'sub_sacco' to choose subsidized sacco
#NOTE: For Pilot we will subsidize Trippin (3) since they were most cooperative in giving matatus
# Use these numbers to match to names for consistency with survey programming:
# SUB_SACCO	NAME_SUB_SACCO
# 0 =	NairobiG
# 1 =	Transafaris
# 2 =	Sasaline
# 3 =	Trippin
# 4	= ClassicLuxuryShuttle
keys <- bind_rows(pure_c, control) %>%  #removed 'treat'
# adding labels
mutate(info = ifelse(key < 20000, 0, ifelse(
key < 60000 & key > 49999, 1, 2)),
infoLabel = ifelse(info == 0, "PureControl", ifelse(
info==1, "Control", "Treatment"))) %>%
group_by(info) %>%
mutate(seq_within = seq_along(info))
keys %<>% mutate(sub_sacco = 3, #Chooses sacco to subsidize
name_sub_sacco = ifelse(sub_sacco==0 & subsidy==1, "NairobiG",
ifelse(sub_sacco==1 & subsidy==1, "Transafaris",
ifelse(sub_sacco==2 & subsidy==1, "Sasaline",
ifelse(sub_sacco==3 & subsidy==1, "Trippin",
ifelse(sub_sacco==4 & subsidy==1, "ClassicLuxuryShuttle", ""))))))
# CREATING FINAL RANDOMIZATION LIST ------------------------------------------------------------------
# rawest form
random_list_tmp <- left_join(order, keys, by = c('infoLabel', 'seq_within'))
# for output
random_list_1 <- random_list_tmp %>% select(-seq_across, -seq_within)
#write_csv(keys, "~/Dropbox/Matatu_project_David_Fred/rct_docs/surveys/look_up/look_up_pilot.csv")
write_csv(random_list_1, "~/Dropbox/Matatu_v2/rct_docs/surveys/look_up/look_up_pilot_pureC_and_C.csv")
summary(as.factor(random_list_1$infoLabel))
setwd("~/Website/gregorylane.github.io")
rmarkdown::render_site()
