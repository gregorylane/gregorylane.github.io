# Setup---------------------
library(pacman)
p_load(readxl, data.table, dplyr, tidyverse, viridis, scales,
knitr, tidytext, tm, sentimentr, magrittr, stargazer,
lfe, fixest)
root <- /Users/glane/Dropbox/Projects/GenderBiases/Data
root <- "/Users/glane/Dropbox/Projects/GenderBiases/Data"
# Load Dataset: Cleaned Chats-------------
options(stringsAsFactors = F)
rm(list = ls())
options(stringsAsFactors=FALSE)
root <- "/Users/glane/Dropbox/Projects/GenderBiases/Data"
chats_expand <- fread(paste0(root, "/Intermediate/chats_cleaned/chats_expand_20190101_20191231_en.csv"), encoding = 'UTF-8')
chats_sentiment <- fread(paste0(root, "/Intermediate/chats_cleaned/chats_sentiment_20190101_20191231_jockers.csv"))
agents <- fread(paste0(root, "/Randomization/treatment_assignment_alldates.csv")) # %>% filter(kenya)
sales <- read_excel(paste0(root, "/Raw/sales/shared/20190101_20191230_sales.xlsx"), sheet = "Sheet1")
agent_day_chat_df <-fread(paste0(root, "/Intermediate/chats_cleaned/agent_day_chat_sales_2019.csv"))
?unite
agents %<>% filter(date <= as.Date("2019-12-31") & date >= as.Date("2019-01-01"), full_name != "NA NA")
agents %<>% unite(full_name, agent_first, agent_last, sep = " ")
agents %<>% filter(date <= as.Date("2019-12-31") & date >= as.Date("2019-01-01"), full_name != "NA NA")
head(agent_day_chat_df)
agent_day_chat_df %<>% mutate(agent_start = as.numeric(agent_start),
customer_respond = as.numeric(customer_respond),
nsales24_d = !is.na(nsales24),
nsales48_d = !is.na(nsales24),
nsales24abs_d =!is.na(nsales24abs),
nsales48abs_d =!is.na(nsales48abs))
agent_day_df <- agent_day_chat_df %>%
group_by(full_name, date) %>%
summarise(nchat = n_distinct(ChatName),
assigned_female = unique(assigned_female))
agent_day_df %<>% full_join(agents %>% select(date, full_name, assigned_female, kenya),
by = c("full_name" = "full_name", "date" = "date", "assigned_female"))
agent_day_df %<>% mutate(nchat_full = ifelse(is.na(nchat), 0, nchat))
agent_day_df_re <- agent_day_df %>% filter(!is.na(assigned_female))
agent_day_chat_df_re <- agent_day_chat_df %>% filter(!is.na(assigned_female))
agent_day_chat_df_re$se <- paste0(agent_day_chat_df_re$full_name, agent_day_chat_df_re$date)
agent_day_df_re$se <- paste0(agent_day_df_re$full_name, agent_day_df_re$date)
quantile(agent_day_chat_df_re$nchat_full, 0.99, na.rm = TRUE)
quantile(agent_day_df_re$nchat_full, 0.99, na.rm = TRUE)
quantile(agent_day_df_re$nchat, 0.99, na.rm = TRUE)
agent_day_df_re %<>% mutate(nchat_full_win = ifelse(nchat_full > quantile(nchat_full, 0.99, na.rm = TRUE),
quantile(nchat_full, 0.99, na.rm = TRUE), nchat_full),
nchat_win = ifelse(nchat > quantile(nchat, 0.99, na.rm = TRUE),
quantile(nchat, 0.99, na.rm = TRUE), nchat))
agent_day_chat_df_re %<>% mutate(word_length_win = ifelse(word_length > quantile(word_length, 0.99, na.rm = TRUE),
quantile(word_length, 0.99, na.rm = TRUE), word_length),
time_length_win = ifelse(time_length > quantile(time_length, 0.99, na.rm = TRUE),
quantile(time_length, 0.99, na.rm = TRUE), time_length),
fm_lengthagent_win = ifelse(fm_lengthagent > quantile(fm_lengthagent, 0.99, na.rm = TRUE),
quantile(fm_lengthagent, 0.99, na.rm = TRUE), fm_lengthagent),
fm_lengthcustomer_win = ifelse(fm_lengthcustomer > quantile(fm_lengthcustomer, 0.99, na.rm = TRUE),
quantile(fm_lengthcustomer, 0.99, na.rm = TRUE), fm_lengthcustomer),
senti_agent_fm_win = ifelse(senti_agent_fm > quantile(senti_agent_fm, 0.99, na.rm = TRUE),
quantile(senti_agent_fm, 0.99, na.rm = TRUE), senti_agent_fm),
senti_agent_nfm_win = ifelse(senti_agent_nfm > quantile(senti_agent_nfm, 0.99, na.rm = TRUE),
quantile(senti_agent_nfm, 0.99, na.rm = TRUE), senti_agent_nfm),
senti_visitor_fm_win = ifelse(senti_visitor_fm > quantile(senti_visitor_fm, 0.99, na.rm = TRUE),
quantile(senti_visitor_fm, 0.99, na.rm = TRUE), senti_visitor_fm),
senti_visitor_nfm_win = ifelse(senti_visitor_nfm > quantile(senti_visitor_nfm, 0.99, na.rm = TRUE),
quantile(senti_visitor_nfm, 0.99, na.rm = TRUE), senti_visitor_nfm))
View(agent_day_chat_df_re)
summary(agent_day_chat_df_re)
View(agent_day_chat_df)
summary(agent_day_chat_df)
table(agent_day_chat_df_re$nsales24)
table(agent_day_chat_df_re$nsales24abs)
summary(agent_day_chat_df_re)
View(agent_day_chat_df)
summary(agent_day_chat_df)
head(sales)
count(unique(sales$USER_IP))
length(unique(sales$USER_IP))
head(agent_day_chat_df_re)
unique(agent_day_chat_df_re$full_name)
head(chats_expand)
temp <- filter()
temp <- filter(chats_expand$`Owner: Full Name`=="Uchenna Egbuonu")
temp <- filter(chats_expand$Full Name=="Uchenna Egbuonu")
names(chats_expand)
temp <- filter(chats_expand$Created By: Full Name=="Uchenna Egbuonu")
temp <- filter(chats_expand$`Created By: Full Name`=="Uchenna Egbuonu")
head(chats_expand)
temp <- filter(chats_expand$`Created By: Full Name`="Uchenna Egbuonu")
temp <- filter(chats_expand$`Created By: Full Name`="Uchenna Egbuonu")
temp <- filter(chats_expand$`Created By: Full Name`=="Uchenna Egbuonu")
temp <- filter(chats_expand, `Created By: Full Name`=="Uchenna Egbuonu")
View(temp)
temp2 <- filter(temp, gsub(Message_english = "Uchenna"))
temp2 <- filter(temp, gsub(Message_english, "Uchenna"))
temp2 <- filter(temp, grep(Message_english, "Uchenna"))
temp2 <- filter(temp, grep("Uchenna", Message_english))
temp2 <- grep("Uchenna", temp$Message_english))
temp2 <- grep("Uchenna", temp$Message_english)
View(agent_day_chat_df_re)
unique(agent_day_chat_df_re$ip_address, agent_day_chat_df_re$full_name)
length(unique(agent_day_chat_df_re$ip_address, agent_day_chat_df_re$full_name))
head(agent_day_chat_df_re)
head(chats_expand)
View(chats_expand)
View(chats_expand)
View(chats_expand)
View(parameters2)
?rbin
?rbinom
q <- 0.1
rbinom(1, 1, q)
rbinom(1, 1, q)
q <- 0.1
q <- 0.1
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(1, 1, q)
rbinom(10, 1, q)
rbinom(1, 10, q)
rbinom(1, 1, q)
rbinom(1, 1, 0.2)
rbinom(10, 1, 0.2)
rbinom(100, 1, 0.2)
matrix(rbinom(100, 1, 0.2))
matrix(rbinom(100, 1, 0.2), 1,2)
?any
?haven
cat("\014") # Clear console
rm(list=ls()) # Clear workspace
library(Rsolnp)
library(data.table)
library(numDeriv)
library(ggplot2)
library(ggmap)
set.seed(12301988)
#####
setwd("~/Documents/Website/gregorylane.github.io")
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
